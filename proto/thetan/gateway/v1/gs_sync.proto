syntax = "proto3";

package thetan.gateway.v1;
import "thetan/immortal/v1/immortal_match.proto";

option go_package = "thetan-buf/gen/go/thetan/gateway/v1;thetan_gateway_v1";
option csharp_namespace = "Thetan.Gateway.V1";

service ThetanGateway {
  rpc Ping(PingRequest) returns (PingResponse) {}
  rpc PlayerConnected(PlayerConnectedRequest) returns (PlayerStatusResponse) {}
  rpc PlayerDisconnected(PlayerDisconnectedRequest) returns (PlayerStatusResponse) {}

  //Immortal
  rpc Immortal_RoomAllocation(thetan.immortal.v1.ImmortalMatchFoundResponseProto) returns (Immortal_RoomAllocationResp) {}
}

message PingRequest {
  string game_server_name = 1;
}

message PingResponse {
  string message = 1;
}

message PlayerConnectedRequest {
  string game_server_name = 1;
  string player_id = 2;
  int32 player_count = 3;
}

message PlayerDisconnectedRequest {
  string game_server_name = 1;
  string player_id = 2;
  int32 player_count = 3;
}

message PlayerStatusResponse {}


message Immortal_RoomAllocationResp{
  //fishnet ip
  string server_ip = 1;
  uint32 server_port = 2;
  //matchid
  string room_id = 3;
}

// nên đặt bên proto của match-director nhưng để đây để tránh import cycle
message Immortal_MatchFoundForMultiplayer {
  Immortal_RoomAllocationResp roomAlloc = 1;
  repeated string partyIDs = 2;
}