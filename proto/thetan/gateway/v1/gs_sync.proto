syntax = "proto3";

package thetan.gateway.v1;
import "thetan/immortal/v1/immortal.proto";

option go_package = "thetan-buf/gen/go/thetan/gateway/v1;thetan_gateway_v1";
option csharp_namespace = "Thetan.Gateway.V1";

service ThetanGateway {
  rpc Ping(PingRequest) returns (PingResponse) {}
  rpc PlayerConnected(PlayerConnectedRequest) returns (PlayerStatusResponse) {}
  rpc PlayerDisconnected(PlayerDisconnectedRequest) returns (PlayerStatusResponse) {}
  rpc RoomDestroyed(RoomDestroyedRequest) returns (RoomDestroyedResponse) {}

  rpc ImmortalRoomAllocation(thetan.immortal.v1.ImmortalMatchFoundResponseProto) returns (ImmortalRoomAllocationResp) {}
}

message PingRequest {
  string game_server_name = 1;
  oneof request {
    RoomInfoRequest room_info = 2;
    // Thêm các trường tùy thuộc vào yêu cầu của game
  }
}

message RoomInfoRequest {
  repeated RoomInfo rooms = 1;
}

message PlayerConnectedRequest {
  string game_server_name = 1;
  oneof request {
    PlayerInfoRequest player_info = 2;
    // Thêm các trường tùy thuộc vào yêu cầu của game
  }
}

message PlayerDisconnectedRequest {
  string game_server_name = 1;
  oneof request {
    PlayerInfoRequest player_info = 2;
    // Thêm các trường tùy thuộc vào yêu cầu của game
  }
}

message PlayerInfoRequest {
  string player_id = 1;
  int32 player_count = 2;
}

message RoomDestroyedRequest {
  string game_server_name = 1;
  oneof request {
    RoomIdRequest room_id_info = 2;
    // Thêm các trường tùy thuộc vào yêu cầu của game
  }
}

message RoomIdRequest {
  string room_id = 1;
}

message PingResponse {
  string message = 1;
}

message PlayerStatusResponse {}

message RoomInfo {
  string room_id = 1;
  int32 player_count = 2;
}

message RoomDestroyedResponse {
  // Thêm các trường phản hồi tùy thuộc vào yêu cầu của bạn
}

message ImmortalRoomAllocationResp {
  //fishnet ip
  string server_ip = 1;
  //matchid
  string room_id = 2;
}
